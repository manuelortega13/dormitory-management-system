<div class="notification-container" #container>
  <button class="notification-btn" (click)="toggleDropdown()">
    <span class="bell-icon">ðŸ””</span>
    @if (notificationService.unreadCount() > 0) {
      <span class="badge">{{ notificationService.unreadCount() > 99 ? '99+' : notificationService.unreadCount() }}</span>
    }
  </button>

  @if (isOpen()) {
    <div class="notification-dropdown">
      <div class="dropdown-header">
        <span class="title">Notifications</span>
        @if (notificationService.unreadCount() > 0) {
          <button class="mark-all-btn" (click)="markAllRead()">Mark all read</button>
        }
      </div>

      <div class="notification-list">
        @if (notificationService.loading()) {
          <div class="loading-state">
            <span>Loading...</span>
          </div>
        } @else if (notificationService.notifications().length === 0) {
          <div class="empty-state">
            <span class="empty-icon">ðŸ”•</span>
            <span>No notifications</span>
          </div>
        } @else {
          @for (notification of notificationService.notifications(); track notification.id) {
            <div 
              class="notification-item" 
              [class.unread]="!notification.is_read"
              (click)="handleNotificationClick(notification)">
              @if (!notification.is_read) {
                <span class="unread-dot"></span>
              }
              <div class="notification-icon">
                <span>{{ getNotificationIcon(notification.type) }}</span>
              </div>
              <div class="notification-content">
                <div class="notification-title">{{ notification.title }}</div>
                <div class="notification-message">{{ notification.message }}</div>
                <div class="notification-time">{{ notificationService.getTimeAgo(notification.created_at) }}</div>
              </div>
              <button class="delete-btn" (click)="deleteNotification($event, notification.id)">
                âœ•
              </button>
            </div>
          }
        }
      </div>
    </div>
  }
</div>
